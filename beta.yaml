#parent=stable.yaml
---
stable:
  ModMetaData: !parent &stable_ModMetaData ModMetaData

ModMetaData: !merge
  <: *stable_ModMetaData
  name: Pick Up And Haul Unloading TEST
  packageId: CodeOptimist.JobsOfOpportunity.BETA
  supportedVersions:
    - 1.2
  modDependencies: !insert
    - !parent ModMetaData.modDependencies
    - packageId: Mlie.PickUpAndHaul
      displayName: Pick Up And Haul (Continued)
      steamWorkshopUrl: steam://url/CommunityFilePage/2277459062
      downloadUrl: https://github.com/emipa606/PickUpAndHaul
  incompatibleWith: !insert
    - !parent ModMetaData.incompatibleWith
    - CodeOptimist.JobsOfOpportunity

published_file_id: 2407750692
preview_from_path: '{local_dir}\..\JoO BETA.png'
setting_prefix: '{stable.ModMetaData.packageId}'

intro: |-
  Beta test for Jobs of Opportunity 2.0: Pick Up And Haul Unloading Improvement.
  (At this point I should probably branch and include PUAH instead of patching it...)
  Stable version is: [url=https://steamcommunity.com/sharedfiles/filedetails/?id=2034960453]{stable.ModMetaData.name}[/url].
  
  {stable_intro}
header: |-
  [b]A pawn's job will say "Opportunistically", "Optimally", or "Efficiently unloading", otherwise it's a different mod[/b] (e.g. normal hauling; normal hauling with [url=https://steamcommunity.com/sharedfiles/filedetails/?id=2277459062]Pick Up And Haul[/url], or triggered by [url=https://steamcommunity.com/sharedfiles/filedetails/?id=1561769193]Common Sense[/url]).
  
  [i]@Modders:[/i] if you set [i]allowOpportunisticPrefix[/i] to [i]false[/i] for a JobDef, it won't allow opportunistic jobs. This is a vanilla feature.

features: !insert
  - [ !parent features, '{title}', [ 0, 1, 2 ] ]
  - title: Efficient unloading
    at: 2.0.0
    desc: |-
      Custom modification of [url=https://steamcommunity.com/sharedfiles/filedetails/?id=2277459062]Pick Up And Haul[/url]. (Optional mod. Installed separately.)
    
      We now control PUAH to eliminate chaotic unloading between stockpiles.
      This also means more hauling opportunities on the way to a separate job.
  
  - title: Haul to inventory
    at: 1.4.0
    desc: |-
      Custom use of [url=https://steamcommunity.com/sharedfiles/filedetails/?id=2277459062]Pick Up And Haul[/url]! (Optional mod. Installed separately.)
    
      PUAH is carefully controlled so only items qualifying as opportunistic will be gathered.
      (Dedicated haul jobs behave as normal, gathering as much as they can.)
  
  - title: More hauling opportunities
    at: 1.0.0
    desc: |-
      Vanilla requires a haulable be near your [b]start[/b] position, and its stockpile near your job. Too far and it won't be hauled, [i]even if it's directly in your path[/i]. We can do better.
    
      We prefer the proximity requirements set by vanilla, but relax them to find valid haulables. Adjustable for performance (see tooltips).

updates: !insert
  - [ !parent updates, '{at}_{credit?}' ]
  - at: 2.0.0
    credit: 'Kellogg''s#0574'
    haul_to_equal_priority: &haulToEqualPriority Allow "Optimize hauling" to same-priority
    desc: |-
    
      • [i]Optimize hauling ingredients/supplies[/i] will trigger more often:
           - Fixed hauling from existing storage, not just un-stored.
           - New [i]{haul_to_equal_priority}[/i] setting (defaults on).
           - Checks closest storage (to destination, not item) for closeness to destination.
  
  # wrapping issues in HugsLib news from e.g. "Prefix " instead of "Prefix"
  - at: 2.0.0
    desc: |-
      • Added "Optimally" and "Efficiently unloading" job prefixes (like "Opportunistically").
      • Updated "Draw opportunistic jobs" to include optimized hauls (magenta & cyan).

settings: !insert
  - [ !parent settings, '{name}' ]
  - name: haulToInventory
    title: Use & improve Pick Up And Haul
    desc: |-
      Controls both efficient unloading and using inventory for opportunistic hauls.
  
  - name: haulToEqualPriority
    title: *haulToEqualPriority
    desc: |-
      This modifies "Optimize hauling" to include delivery to same-priority storage.
  
  - name: drawOpportunisticJobs
    title: Draw opportunistic & optimal jobs
    desc: |-
      Original job paths are red, new opportunistic paths are green.
      Original ingredient/supply paths are magenta, new optimal paths are cyan.
    
      (This is sync'd to vanilla's [i]Development mode → inspector icon → Visibility → Draw Opportunistic Jobs, which is why it doesn't persist through restarts.)[/i]
